"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[748],{1154:(e,t,a)=>{a.d(t,{A:()=>s});let s=(0,a(9946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},5695:(e,t,a)=>{var s=a(8999);a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},9748:(e,t,a)=>{a.d(t,{default:()=>d});var s=a(5155),l=a(2115),n=a(1154);let i=e=>{if(!e)return"";let[t,a,s]=e.split("/");return"".concat(s,"-").concat(a,"-").concat(t)},r=e=>{let{onClose:t,defaultData:a}=e,[r,o]=(0,l.useState)({nome:"",data_i:"",data_f:"",costo_settimana:0,n_settimane:0}),[d,c]=(0,l.useState)(null),[m,u]=(0,l.useState)(!1),[x,h]=(0,l.useState)(!1);(0,l.useEffect)(()=>{a&&o({nome:a.nome||"",data_i:i(a.data_i),data_f:i(a.data_f),costo_settimana:a.costo_settimana||0,n_settimane:a.n_settimane||0})},[a]);let f=e=>{let{name:t,value:a}=e.target;o(e=>({...e,[t]:a}))},b=async e=>{e.preventDefault(),c(null),u(!1),h(!0);try{let e=a?"/api/updateAttivita":"/api/insertAttivita",s=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),l=await s.json();h(!1),s.ok?(c(l.message||"Attivit\xe0 salvata con successo!"),u(!1),setTimeout(()=>{t()},1e3)):(c(l.message||"Errore nel salvataggio."),u(!0))}catch(e){h(!1),c("Errore di rete o del server."+e),u(!0)}};return(0,s.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[[{label:"Nome",name:"nome",type:"text"},{label:"Data Inizio",name:"data_i",type:"date"},{label:"Data Fine",name:"data_f",type:"date"},{label:"Costo a Settimana (€)",name:"costo_settimana",type:"number"},{label:"Numero Settimane",name:"n_settimane",type:"number"}].map(e=>{var t;return(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",htmlFor:e.name,children:e.label}),(0,s.jsx)("input",{type:e.type,name:e.name,id:e.name,value:null!==(t=r[e.name])&&void 0!==t?t:"",onChange:f,className:"w-full px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#f8ecad]",required:!0,readOnly:"attivita"===e.name&&!!a})]},e.name)}),(0,s.jsx)("div",{className:"text-center mt-2 min-h-[20px]",children:x?(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(n.A,{className:"animate-spin h-5 w-5"})}):d?(0,s.jsx)("div",{className:"text-sm font-medium ".concat(m?"text-red-600":"text-green-600"),children:d}):null}),(0,s.jsxs)("div",{className:"flex justify-between mt-6",children:[(0,s.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 rounded-xl text-sm",children:"Annulla"}),(0,s.jsx)("button",{type:"submit",disabled:x,className:"px-4 py-2 bg-[#fdeb90] hover:bg-[#fdea87] text-black font-semibold rounded-xl text-sm",children:"Salva"})]})]})};var o=a(5695);let d=()=>{let e=(0,o.useRouter)(),[t,a]=(0,l.useState)([]),[i,d]=(0,l.useState)(!1),[c,m]=(0,l.useState)(null),[u,x]=(0,l.useState)(null),[h,f]=(0,l.useState)(!1),[b,p]=(0,l.useState)(null),g=async()=>{try{let e=await fetch("/api/getAttivita"),t=await e.json();a(t)}catch(e){console.error("Errore nel recupero delle attivit\xe0",e)}};(0,l.useEffect)(()=>{g()},[]);let v=async()=>{if(u){f(!0),p(null);try{let e=await fetch("/api/deleteAttivita",{method:"POST",body:JSON.stringify({id:u._id})}),t=await e.json();e.ok?(p("Attivit\xe0 eliminata con successo."),setTimeout(()=>{x(null),g()},1e3)):p(t.message||"Errore durante l'eliminazione.")}catch(e){p("Errore imprevisto."),console.error("Errore:",e)}finally{f(!1)}}};return(0,s.jsxs)("div",{className:"min-h-screen py-10 px-4 flex flex-col items-center relative",children:[(0,s.jsx)("h1",{className:"text-3xl font-semibold text-center mb-8 w-full",children:"Attivit\xe0"}),(0,s.jsx)("button",{onClick:()=>{m(null),d(!0)},className:"absolute top-6 right-6 bg-[#fdeb90] hover:bg-[#fdea87] text-black font-bold rounded-full w-12 h-12 text-2xl flex items-center justify-center shadow-md transition",title:"Aggiungi attivit\xe0",children:"+"}),i?(0,s.jsxs)("div",{className:"w-full max-w-md mt-10 bg-white p-8 shadow-xl rounded-2xl",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold mb-4 text-center",children:c?"Modifica Attivit\xe0":"Nuova Attivit\xe0"}),(0,s.jsx)(r,{onClose:()=>{d(!1),g()},defaultData:c||void 0})]}):(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-8 w-full max-w-6xl",children:t.map(t=>(0,s.jsxs)("div",{className:"bg-white shadow-xl rounded-2xl p-6 relative",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-1",children:t.nome}),(0,s.jsxs)("p",{className:"text-gray-700",children:["Dal ",(0,s.jsx)("strong",{children:t.data_i})," al ",(0,s.jsx)("strong",{children:t.data_f})]}),(0,s.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:[t.n_settimane," settimane - ",t.costo_settimana,"€/settimana"]}),(0,s.jsxs)("div",{className:"grid grid-cols-2",children:[(0,s.jsx)("div",{className:"flex justify-start gap-2 mt-4",children:(0,s.jsx)("button",{onClick:()=>{e.push("/iscritti")},className:"px-3 py-1 bg-[#465c9783] hover:bg-[#465c97c9] rounded-xl text-sm font-semibold text-white",children:"Iscritti"})}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,s.jsx)("button",{onClick:()=>{m(t),d(!0)},className:"px-3 py-1 bg-[#fdeb90a6] hover:bg-[#fdea87] rounded-xl text-sm font-semibold",children:"Modifica"}),(0,s.jsx)("button",{onClick:()=>x(t),className:"px-3 py-1 bg-red-400 hover:bg-red-500 rounded-xl text-sm font-semibold text-white",children:"Elimina"})]})]})]},t._id))}),u&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("style",{children:"body { overflow: hidden; }"}),(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40 pointer-events-auto"}),(0,s.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-lg w-full max-w-sm",children:[(0,s.jsx)("h2",{className:"text-lg font-bold mb-4 text-center",children:"Conferma Eliminazione"}),(0,s.jsxs)("p",{className:"text-center text-gray-700 mb-4",children:["Sei sicuro di voler eliminare ",(0,s.jsx)("strong",{children:u.nome}),"?"]}),h?(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(n.A,{className:"animate-spin h-5 w-5"})}):b?(0,s.jsx)("p",{className:"text-center text-sm text-gray-700 mb-4",children:b}):null,(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("button",{disabled:h,onClick:()=>{x(null),p(null),document.body.style.overflow="auto"},className:"px-4 py-2 rounded-xl bg-gray-300 hover:bg-gray-400 text-sm",children:"Annulla"}),(0,s.jsx)("button",{disabled:h,onClick:()=>{v(),document.body.style.overflow="auto"},className:"px-4 py-2 rounded-xl bg-red-500 hover:bg-red-600 text-white text-sm font-semibold",children:"Elimina"})]})]})})]})]})}},9946:(e,t,a)=>{a.d(t,{A:()=>c});var s=a(2115);let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),i=e=>{let t=n(e);return t.charAt(0).toUpperCase()+t.slice(1)},r=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,s.forwardRef)((e,t)=>{let{color:a="currentColor",size:l=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:d="",children:c,iconNode:m,...u}=e;return(0,s.createElement)("svg",{ref:t,...o,width:l,height:l,stroke:a,strokeWidth:i?24*Number(n)/Number(l):n,className:r("lucide",d),...u},[...m.map(e=>{let[t,a]=e;return(0,s.createElement)(t,a)}),...Array.isArray(c)?c:[c]])}),c=(e,t)=>{let a=(0,s.forwardRef)((a,n)=>{let{className:o,...c}=a;return(0,s.createElement)(d,{ref:n,iconNode:t,className:r("lucide-".concat(l(i(e))),"lucide-".concat(e),o),...c})});return a.displayName=i(e),a}}}]);